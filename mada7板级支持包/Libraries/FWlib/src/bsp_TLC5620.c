#include "bsp_TLC5620.h"

#if BSP_TLC5620

void	DacX_Channel_write(unsigned char Channel,unsigned char num,unsigned char rng)
{
	unsigned char i=0x80,j;
	if(Channel==DacA)
	{
		Clk_On;
		delay(0xF);
		Data_Off;
		Clk_Off;
		delay(0xF);
		Clk_On;
		delay(0xF);
		Clk_Off;
	}
	if(Channel==DacB)
	{
		Clk_On;
		delay(0xF);
		Data_Off;
		Clk_Off;
		delay(0xF);
		Clk_On;
		Data_On;
		delay(0xF);
		Clk_Off;
	}
	if(Channel==DacC)
	{
		Clk_On;
		Data_On;
		delay(0xF);
		Clk_Off;
		delay(0xF);
		Clk_On;
		Data_Off;
		delay(0xF);
		Clk_Off;
	}
	if(Channel==DacD)
	{
		Clk_On;
		Data_On;
		delay(0xF);
		Clk_Off;
		delay(0xF);
		Clk_On;
		Data_On;
		delay(0xF);
		Clk_Off;
	}
	if(rng==0)
	{
		delay(0xF);
		Clk_On;
		delay(0xF);
		Clk_Off;
		delay(0xF);
		Clk_On;
	}
	else
	{
		delay(0xF);
		Clk_On;
		delay(0xF);
		Data_On;
		Clk_Off;
		delay(0xF);
		Clk_On;
	}
	for(j=0;j<8;j++)
	{
		if(num&i)
		{
			delay(0xF);
			Data_On;
			Clk_Off;
			delay(0xF);
			Clk_On;
			i>>=1;
		}
		else
		{
			delay(0xF);
			Data_Off;
			Clk_Off;
			delay(0xF);
			Clk_On;
			i>>=1;
		}
	}
	Load_Off;
	Ldac_Off;
	delay(0xF);
	Ldac_On;
	Load_On;
	delay(0xF);
}

void	DacA_write(unsigned char num,unsigned char rng)
{
	unsigned char i=0x80,j;
	Clk_On;
	delay(0xF);
	Data_Off;
	Clk_Off;
	delay(0xF);
	Clk_On;
	delay(0xF);
	Clk_Off;
	if(rng==0)
	{
		delay(0xF);
		Clk_On;
		delay(0xF);
		Clk_Off;
		delay(0xF);
		Clk_On;
	}
	else
	{
		delay(0xF);
		Clk_On;
		delay(0xF);
		Data_On;
		Clk_Off;
		delay(0xF);
		Clk_On;
	}
	for(j=0;j<8;j++)
	{
		if(num&i)
		{
			delay(0xF);
			Data_On;
			Clk_Off;
			delay(0xF);
			Clk_On;
			i>>=1;
		}
		else
		{
			delay(0xF);
			Data_Off;
			Clk_Off;
			delay(0xF);
			Clk_On;
			i>>=1;
		}
	}
	Load_Off;
	Ldac_Off;
	delay(0xF);
	Ldac_On;
	Load_On;
	delay(0xF);
}


void	DacB_write(unsigned char num,unsigned char rng)
{
	unsigned char i=0x80,j;
	Clk_On;
	delay(0xF);
	Data_Off;
	Clk_Off;
	delay(0xF);
	Clk_On;
	Data_On;
	delay(0xF);
	Clk_Off;
	if(rng==0)
	{
		delay(0xF);
		Clk_On;
		Data_Off;
		delay(0xF);
		Clk_Off;
		delay(0xF);
		Clk_On;
	}
	else
	{
		delay(0xF);
		Clk_On;
		delay(0xF);
		Data_On;
		Clk_Off;
		delay(0xF);
		Clk_On;
	}
	for(j=0;j<8;j++)
	{
		if(num&i)
		{
			delay(0xF);
			Data_On;
			Clk_Off;
			delay(0xF);
			Clk_On;
			i>>=1;
		}
		else
		{
			delay(0xF);
			Data_Off;
			Clk_Off;
			delay(0xF);
			Clk_On;
			i>>=1;
		}
	}
	Load_Off;
	Ldac_Off;
	delay(0xF);
	Ldac_On;
	Load_On;
	delay(0xF);
}

void	DacC_write(unsigned char num,unsigned char rng)
{
	unsigned char i=0x80,j;
	Clk_On;
	Data_On;
	delay(0xF);
	Clk_Off;
	delay(0xF);
	Clk_On;
	Data_Off;
	delay(0xF);
	Clk_Off;
	if(rng==0)
	{
		delay(0xF);
		Clk_On;
		delay(0xF);
		Clk_Off;
		delay(0xF);
		Clk_On;
	}
	else
	{
		delay(0xF);
		Clk_On;
		delay(0xF);
		Data_On;
		Clk_Off;
		delay(0xF);
		Clk_On;
	}
	for(j=0;j<8;j++)
	{
		if(num&i)
		{
			delay(0xF);
			Data_On;
			Clk_Off;
			delay(0xF);
			Clk_On;
			i>>=1;
		}
		else
		{
			delay(0xF);
			Data_Off;
			Clk_Off;
			delay(0xF);
			Clk_On;
			i>>=1;
		}
	}
	Load_Off;
	Ldac_Off;
	delay(0xF);
	Ldac_On;
	Load_On;
	delay(0xF);
}

void	DacD_write(unsigned char num,unsigned char rng)
{
	unsigned char i=0x80,j;
	Clk_On;
	Data_On;
	delay(0xF);
	Clk_Off;
	delay(0xF);
	Clk_On;
	Data_On;
	delay(0xF);
	Clk_Off;
	if(rng==0)
	{
		delay(0xF);
		Clk_On;
		delay(0xF);
		Clk_Off;
		delay(0xF);
		Clk_On;
	}
	else
	{
		delay(0xF);
		Clk_On;
		delay(0xF);
		Data_On;
		Clk_Off;
		delay(0xF);
		Clk_On;
	}
	for(j=0;j<8;j++)
	{
		if(num&i)
		{
			delay(0xF);
			Data_On;
			Clk_Off;
			delay(0xF);
			Clk_On;
			i>>=1;
		}
		else
		{
			delay(0xF);
			Data_Off;
			Clk_Off;
			delay(0xF);
			Clk_On;
			i>>=1;
		}
	}
	Load_Off;
	Ldac_Off;
	delay(0xF);
	Ldac_On;
	Load_On;
	delay(0xF);
}

#endif

